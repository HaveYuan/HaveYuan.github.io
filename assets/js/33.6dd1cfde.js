(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{537:function(t,a,s){"use strict";s.r(a);var n=s(4),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("在用ejs模板进行渲染时遇到这样一个问题，nodejs端返回一个数组，在模板渲染出来的结果不是想要的数据，如下：")]),t._v(" "),s("div",{staticClass:"language-javascritpt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n  let hotBrandList = [];\n  let hotBrandIds = [];\n\n  //获取热门品牌id\n  let _hotBrandList = yield autopriceFunc.getHotBrands();\n\n  if(_hotBrandList.data.code == 0) {\n      hotBrandIds = _hotBrandList.data.data.list;\n      for(let i=0; i<hotBrandIds.length; i++) {\n          let bItem = yield autopriceFunc.getBrandInfo(hotBrandIds[i], {id:'',name:'',logo96x96:''});\n          hotBrandList.push(bItem);\n      }\n  }\n\n  console.log(hotBrandList);\n")])])]),s("p",[t._v("模板里是这样的")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("\nhotBrands = <%=hotBrandList%>;\nconsole.log(hotBrands)\n")])])]),s("p",[s("code",[t._v("hotBrands")]),t._v(" 应该是一个对象数组，结果打印出来的结果是下图这样的，用 "),s("code",[t._v("encodeURIComponent")]),t._v(" 转换后结果也还是一样")]),t._v(" "),s("p",[s("img",{attrs:{src:"/blog/nodejs_arr/1.webp",alt:"图片"}})]),t._v(" "),s("p",[t._v("浏览器自动转换了，于是我想着把"),s("code",[t._v("hotBrands")]),t._v("转化成"),s("code",[t._v("json")]),t._v("字符串,如下：")]),t._v(" "),s("div",{staticClass:"language-javascritpt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(" ···\n\n hotBrandList = JSON.stringify(hotBrandList);\n")])])]),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("hotBrands = JSON.parse('<%=hotBrandList%>');\nconsole.log(hotBrands)\n")])])]),s("p",[t._v("结果如下")]),t._v(" "),s("p",[s("img",{attrs:{src:"/blog/nodejs_arr/2.webp",alt:"图片"}})]),t._v(" "),s("p",[t._v("还是不能正常显示")]),t._v(" "),s("p",[t._v("最后我试着两着结合")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("  hotBrandList "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("encodeURIComponent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("stringify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hotBrandList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("  hotBrands = JSON.parse(decodeURIComponent('<%=hotBrandList%>'));\n")])])]),s("p",[t._v("结果如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/blog/nodejs_arr/3.webp",alt:"图片"}})]),t._v(" "),s("p",[t._v("终于正常显示了，好坑。")]),t._v(" "),s("p",[t._v("所以在用模板渲染时要注意一些特殊数据类型或符号可能会被浏览器转换，如果遇到了需要特殊处理一下。")]),t._v(" "),s("cheers"),t._v(" "),s("pay")],1)}),[],!1,null,null,null);a.default=e.exports}}]);